<div class="au-university-detail-container">
  <!-- Hero Section -->
  <section class="hero-section">
    <% if @university.images.present? %>
      <% images = JSON.parse(@university.images) %>
      <% credits = JSON.parse(@university.image_credits || '[]') %>
      <div class="hero-image-slider">
        <div class="hero-slider-wrapper">
          <% images.each_with_index do |image, index| %>
            <div class="hero-slide <%= 'active' if index == 0 %>">
              <% if image.start_with?('http', '/images/') %>
                <img src="<%= image %>" alt="<%= @university.name %> Campus <%= index + 1 %>">
              <% else %>
                <% clean_path = image.start_with?('/assets/') ? image.sub('/assets/', '') : image %>
                <%= image_tag clean_path, alt: "#{@university.name} Campus #{index + 1}" %>
              <% end %>
              <% if credits[index].present? %>
                <div class="image-credit"><%= credits[index] %></div>
              <% end %>
            </div>
          <% end %>
        </div>
        <% if images.length > 1 %>
          <button class="hero-slider-btn hero-slider-prev">
            <i class="fas fa-chevron-left"></i>
          </button>
          <button class="hero-slider-btn hero-slider-next">
            <i class="fas fa-chevron-right"></i>
          </button>
          <div class="hero-slider-dots">
            <% images.each_with_index do |_, index| %>
              <span class="hero-dot <%= 'active' if index == 0 %>" data-slide="<%= index %>"></span>
            <% end %>
          </div>
        <% end %>
      </div>
    <% end %>
    <div class="hero-content <%= 'no-image' unless @university.images.present? %>">
      <div class="hero-breadcrumb">
        <%= link_to "オーストラリア大学検索", au_universities_path %> &gt; <%= @university.name %>
      </div>
      <h1 class="hero-title"><%= @university.name %></h1>
      <div class="hero-meta">
        <span class="hero-location">
          <i class="fas fa-map-marker-alt"></i>
          <%= @university.city %>, <%= @university.state %>
        </span>
        <% if @university.website.present? %>
          <%= link_to @university.website, @university.website, target: "_blank", rel: "noopener", class: "hero-website" %>
        <% end %>
      </div>
      <div class="hero-divider"></div>
    </div>
  </section>

  <% if @university.images.present? %>
    <section class="section-wrapper">
      <div class="section-content">
        <div class="image-note">
          ※ 画像はWikimedia Commons APIより自動取得されたものです。関連性の低い画像が表示される場合があります。
        </div>
      </div>
    </section>
  <% end %>

  <!-- Stats Section -->
  <section class="section-wrapper stats-section-bg">
    <div class="section-content">
      <div class="university-stats-grid">
        <div class="stat-card">
          <div class="stat-icon"><i class="fas fa-users"></i></div>
          <div class="stat-content">
            <div class="stat-value"><%= number_with_delimiter(@university.total_students_2023 || 0) %></div>
            <div class="stat-label">全学生数（2023年）</div>
          </div>
        </div>

        <div class="stat-card">
          <div class="stat-icon"><i class="fas fa-user-plus"></i></div>
          <div class="stat-content">
            <div class="stat-value"><%= number_with_delimiter(@university.commencing_students_2023 || 0) %></div>
            <div class="stat-label">新入生（2023年）</div>
          </div>
        </div>

        <div class="stat-card">
          <div class="stat-icon"><i class="fas fa-chart-line"></i></div>
          <div class="stat-content">
            <div class="stat-value">
              <% if @university.student_growth_rate %>
                <%= @university.student_growth_rate > 0 ? '+' : '' %><%= @university.student_growth_rate.round(1) %>%
              <% else %>
                -
              <% end %>
            </div>
            <div class="stat-label">学生数成長率</div>
          </div>
        </div>

        <div class="stat-card">
          <div class="stat-icon"><i class="fas fa-globe"></i></div>
          <div class="stat-content">
            <div class="stat-value">
              <% if @university.overseas_students_2023 %>
                <%= number_with_delimiter(@university.overseas_students_2023) %>
              <% else %>
                -
              <% end %>
            </div>
            <div class="stat-label">留学生数（推定）※</div>
          </div>
        </div>

        <div class="stat-card">
          <div class="stat-icon"><i class="fas fa-percentage"></i></div>
          <div class="stat-content">
            <div class="stat-value">
              <% if @university.overseas_percentage %>
                <%= @university.overseas_percentage.round(1) %>%
              <% else %>
                -
              <% end %>
            </div>
            <div class="stat-label">留学生比率（推定）※</div>
          </div>
        </div>

        <div class="stat-card">
          <div class="stat-icon"><i class="fas fa-graduation-cap"></i></div>
          <div class="stat-content">
            <div class="stat-value"><%= @university.total_courses_count %></div>
            <div class="stat-label">総コース数</div>
          </div>
        </div>

        <div class="stat-card">
          <div class="stat-icon"><i class="fas fa-user-graduate"></i></div>
          <div class="stat-content">
            <div class="stat-value"><%= @university.bachelor_courses_count %></div>
            <div class="stat-label">学士課程</div>
          </div>
        </div>

        <div class="stat-card">
          <div class="stat-icon"><i class="fas fa-award"></i></div>
          <div class="stat-content">
            <div class="stat-value"><%= @university.masters_courses_count %></div>
            <div class="stat-label">修士課程</div>
          </div>
        </div>

        <div class="stat-card">
          <div class="stat-icon"><i class="fas fa-dollar-sign"></i></div>
          <div class="stat-content">
            <div class="stat-value">
              <% if @university.min_annual_tuition && @university.max_annual_tuition %>
                $<%= number_with_delimiter(@university.min_annual_tuition.to_i) %>
              <% else %>
                データなし
              <% end %>
            </div>
            <div class="stat-label">最低年間授業料（AUD）</div>
          </div>
        </div>

        <div class="stat-card">
          <div class="stat-icon"><i class="fas fa-money-bill-wave"></i></div>
          <div class="stat-content">
            <div class="stat-value">
              <% if @university.max_annual_tuition %>
                $<%= number_with_delimiter(@university.max_annual_tuition.to_i) %>
              <% else %>
                データなし
              <% end %>
            </div>
            <div class="stat-label">最高年間授業料（AUD）</div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <% if @university.description.present? %>
    <!-- Description Section -->
    <section class="section-wrapper">
      <div class="section-content">
        <div class="info-card">
          <h2>大学概要</h2>
          <p><%= @university.description %></p>
        </div>
      </div>
    </section>
  <% end %>

  <% if @university.highlights.present? %>
    <!-- Highlights Section -->
    <section class="section-wrapper alt-bg">
      <div class="section-content">
        <div class="info-card">
          <h2>特徴・強み</h2>
          <div class="highlights-content">
            <%= simple_format(@university.highlights) %>
          </div>
        </div>
      </div>
    </section>
  <% end %>

  <% if @university.famous_alumni.present? %>
    <!-- Alumni Section -->
    <section class="section-wrapper">
      <div class="section-content">
        <div class="info-card">
          <h2>著名な卒業生</h2>
          <p><%= @university.famous_alumni %></p>
        </div>
      </div>
    </section>
  <% end %>

  <% if @university.popular_fields.present? %>
    <!-- Popular Fields Section -->
    <section class="section-wrapper alt-bg">
      <div class="section-content">
        <div class="info-card">
          <h2>人気の分野</h2>
          <div class="fields-content">
            <%= @university.popular_fields %>
          </div>
        </div>
      </div>
    </section>
  <% end %>

  <!-- Courses Section -->
  <section class="section-wrapper courses-section-bg" id="courses">
    <div class="section-content wide">
      <div class="courses-card">
        <div class="courses-header">
          <h2>提供コース一覧</h2>
          <div class="course-filters">
            <%= form_with url: au_university_path(@university, anchor: 'courses'), method: :get, local: true, class: "filter-form" do |f| %>
              <div class="filter-group">
                <%= select_tag :level,
                    options_for_select([
                      ['全レベル', ''],
                      ['学士課程', 'bachelor'],
                      ['修士課程', 'masters'],
                      ['博士課程', 'doctoral']
                    ], params[:level]),
                    class: "filter-select",
                    onchange: "submitWithScroll(this.form)" %>

                <%= select_tag :field,
                    options_for_select([
                      ['全分野', ''],
                      ['Natural and Physical Sciences (自然科学・物理科学)', '01 - Natural and Physical Sciences'],
                      ['Information Technology (情報技術)', '02 - Information Technology'],
                      ['Engineering and Related Technologies (工学・関連技術)', '03 - Engineering and Related Technologies'],
                      ['Architecture and Building (建築・建設)', '04 - Architecture and Building'],
                      ['Agriculture, Environmental and Related Studies (農業・環境・関連研究)', '05 - Agriculture, Environmental and Related Studies'],
                      ['Health (健康・医療)', '06 - Health'],
                      ['Education (教育)', '07 - Education'],
                      ['Management and Commerce (経営・商学)', '08 - Management and Commerce'],
                      ['Society and Culture (社会・文化)', '09 - Society and Culture'],
                      ['Creative Arts (創造芸術)', '10 - Creative Arts']
                    ], params[:field]),
                    class: "filter-select",
                    onchange: "submitWithScroll(this.form)" %>

                <%= select_tag :sort,
                    options_for_select([
                      ['並べ替え', ''],
                      ['コース名順', 'name'],
                      ['授業料（安い順）', 'tuition_asc'],
                      ['授業料（高い順）', 'tuition_desc'],
                      ['期間（短い順）', 'duration_asc'],
                      ['期間（長い順）', 'duration_desc']
                    ], params[:sort]),
                    class: "filter-select",
                    onchange: "submitWithScroll(this.form)" %>
              </div>
            <% end %>
          </div>
        </div>

        <div class="courses-table">
          <table>
            <thead>
              <tr>
                <th>コース名</th>
                <th>分野</th>
                <th>レベル</th>
                <th>期間</th>
                <th>年間授業料（AUD）</th>
              </tr>
            </thead>
            <tbody>
              <% @courses.each do |course| %>
                <tr>
                  <td class="course-name" data-label="コース名">
                    <div class="course-name-wrapper">
                      <div class="course-name-en"><%= course.course_name %></div>
                      <div class="course-name-ja"><%= translate_common_course_terms(course.course_name) %></div>
                    </div>
                  </td>
                  <td data-label="分野">
                    <% if course.field_of_education_broad.present? %>
                      <div class="field-wrapper">
                        <div class="field-en"><%= course.field_of_education_broad %></div>
                        <div class="field-ja"><%= translate_au_field(course.field_of_education_broad) %></div>
                      </div>
                    <% else %>
                      -
                    <% end %>
                  </td>
                  <td data-label="レベル">
                    <span class="level-badge level-<%= course.course_level&.downcase&.gsub(' ', '-') %>">
                      <div class="level-en"><%= course.course_level || '-' %></div>
                      <div class="level-ja"><%= translate_au_course_level(course.course_level) if course.course_level %></div>
                    </span>
                  </td>
                  <td data-label="期間"><%= course.duration_years ? "#{course.duration_years}年" : '-' %></td>
                  <td class="tuition" data-label="年間授業料">
                    <% if course.annual_tuition_fee %>
                      $<%= number_with_delimiter(course.annual_tuition_fee.to_i) %>
                    <% else %>
                      -
                    <% end %>
                  </td>
                </tr>
              <% end %>
            </tbody>
          </table>
        </div>

        <% if @courses.respond_to?(:total_pages) %>
          <div class="pagination">
            <%= paginate @courses %>
          </div>
        <% end %>
      </div>
    </div>
  </section>

  <!-- Data Note Section -->
  <section class="section-wrapper note-section-bg">
    <div class="section-content">
      <div class="data-note">
        <p><strong>※注記:</strong></p>
        <p>• 留学生数および留学生比率は、EFTSL（Equivalent Full-Time Student Load）データを基にした推定値です。実際の学生数とは異なる場合があります。</p>
        <p>• 掲載されている画像は、Wikimedia Commons APIを使用して自動取得されたものです。大学名での検索結果を表示しているため、実際のキャンパスと異なる場合や関連性の低い画像が含まれている可能性があります。</p>
      </div>
    </div>
  </section>
</div>

<style>
  /* Container */
  .au-university-detail-container {
    max-width: 100%;
    margin: 0;
    padding: 0;
    background: #ffffff;
  }

  /* Hero Section */
  .hero-section {
    background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
    position: relative;
    overflow: hidden;
  }

  .hero-image-slider {
    position: relative;
    width: 100%;
    height: 450px;
    overflow: hidden;
  }

  .hero-slider-wrapper {
    display: flex;
    height: 100%;
    transition: transform 0.3s ease;
  }

  .hero-slide {
    min-width: 100%;
    height: 100%;
    display: none;
    position: relative;
  }

  .hero-slide.active {
    display: block;
  }

  .hero-slide img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .hero-slider-btn {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    background: rgba(255, 255, 255, 0.9);
    border: none;
    width: 44px;
    height: 44px;
    border-radius: 50%;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s ease;
    font-size: 18px;
    color: #4a5568;
    z-index: 2;
  }

  .hero-slider-btn:hover {
    background: white;
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
  }

  .hero-slider-prev { left: 20px; }
  .hero-slider-next { right: 20px; }

  .hero-slider-dots {
    position: absolute;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    gap: 8px;
    z-index: 2;
  }

  .hero-dot {
    width: 10px;
    height: 10px;
    border-radius: 50%;
    background: rgba(255, 255, 255, 0.6);
    cursor: pointer;
    transition: all 0.3s ease;
  }

  .hero-dot.active {
    background: white;
    width: 30px;
    border-radius: 5px;
  }

  .image-credit {
    position: absolute;
    top: 10px;
    right: 10px;
    background: rgba(0, 0, 0, 0.5);
    color: white;
    padding: 4px 8px;
    border-radius: 4px;
    font-size: 10px;
    backdrop-filter: blur(5px);
    opacity: 0.8;
  }

  .hero-content {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    padding: 60px 20px 40px;
    background: linear-gradient(to top, rgba(0, 0, 0, 0.95) 0%, rgba(0, 0, 0, 0.7) 60%, transparent 100%);
    color: white;
    text-align: center;
  }

  .hero-content.no-image {
    position: relative;
    padding: 80px 20px;
    background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
  }

  .hero-breadcrumb {
    font-size: 14px;
    color: rgba(255, 255, 255, 0.7);
    margin-bottom: 15px;
  }

  .hero-breadcrumb a {
    color: rgba(255, 255, 255, 0.9);
    text-decoration: none;
  }

  .hero-breadcrumb a:hover {
    text-decoration: underline;
  }

  .hero-title {
    font-size: 42px;
    font-weight: 700;
    margin: 0 0 15px 0;
    letter-spacing: -0.5px;
  }

  .hero-meta {
    display: flex;
    justify-content: center;
    gap: 30px;
    align-items: center;
    font-size: 16px;
    flex-wrap: wrap;
  }

  .hero-location {
    color: rgba(255, 255, 255, 0.9);
  }

  .hero-website {
    color: white;
    text-decoration: none;
    padding: 8px 16px;
    background: rgba(255, 255, 255, 0.2);
    border-radius: 20px;
    transition: background 0.3s;
    font-size: 14px;
  }

  .hero-website:hover {
    background: rgba(255, 255, 255, 0.3);
  }

  .hero-divider {
    width: 60px;
    height: 3px;
    background: #4a7fba;
    margin: 25px auto 0;
  }

  /* Section Wrapper */
  .section-wrapper {
    padding: 50px 20px;
  }

  .section-content {
    max-width: 900px;
    margin: 0 auto;
  }

  .section-content.wide {
    max-width: 1200px;
  }

  /* Alternating Backgrounds */
  .alt-bg {
    background: #f5f5f5;
  }

  .stats-section-bg {
    background: #f5f5f5;
  }

  .courses-section-bg {
    background: #ffffff;
  }

  .note-section-bg {
    background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
  }

  /* Image Note */
  .image-note {
    text-align: center;
    color: #999;
    font-size: 13px;
    font-style: italic;
  }

  /* Stats Grid */
  .university-stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
    gap: 16px;
  }

  .stat-card {
    background: white;
    border-radius: 8px;
    padding: 20px;
    border: 1px solid #e5e5e5;
    display: flex;
    align-items: center;
    gap: 14px;
    transition: border-color 0.2s ease;
  }

  .stat-card:hover {
    border-color: #4a7fba;
  }

  .stat-icon {
    width: 42px;
    height: 42px;
    background: #f5f5f5;
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: #4a7fba;
    font-size: 16px;
    flex-shrink: 0;
  }

  .stat-content {
    flex: 1;
    min-width: 0;
  }

  .stat-value {
    font-size: 24px;
    font-weight: 700;
    color: #1a1a1a;
  }

  .stat-label {
    font-size: 12px;
    color: #666;
    margin-top: 2px;
  }

  /* Info Card */
  .info-card {
    background: white;
    padding: 40px;
    border-radius: 8px;
    border: 1px solid #e5e5e5;
  }

  .info-card h2 {
    font-size: 28px;
    font-weight: 700;
    color: #1a1a1a;
    margin: 0 0 20px 0;
  }

  .info-card p {
    font-size: 15px;
    line-height: 1.8;
    color: #555;
    margin: 0;
  }

  .highlights-content {
    color: #555;
    line-height: 1.8;
  }

  .highlights-content p {
    margin: 10px 0;
  }

  .fields-content {
    color: #555;
    line-height: 1.8;
  }

  /* Courses Card */
  .courses-card {
    background: white;
    padding: 40px;
    border-radius: 8px;
    border: 1px solid #e5e5e5;
  }

  .courses-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 25px;
    flex-wrap: wrap;
    gap: 20px;
  }

  .courses-header h2 {
    font-size: 28px;
    font-weight: 700;
    color: #1a1a1a;
    margin: 0;
  }

  .filter-form {
    margin: 0;
  }

  .filter-group {
    display: flex;
    gap: 10px;
  }

  .filter-select {
    padding: 10px 14px;
    border: 1px solid #e2e8f0;
    border-radius: 6px;
    background: white;
    cursor: pointer;
    font-size: 14px;
  }

  /* Courses Table */
  .courses-table {
    overflow-x: auto;
  }

  .courses-table table {
    width: 100%;
    border-collapse: collapse;
  }

  .courses-table th {
    background: #f7fafc;
    padding: 14px;
    text-align: left;
    font-weight: 600;
    color: #4a5568;
    border-bottom: 2px solid #e2e8f0;
    font-size: 14px;
  }

  .courses-table td {
    padding: 14px;
    border-bottom: 1px solid #e2e8f0;
    font-size: 14px;
  }

  .courses-table tbody tr:hover {
    background: #f7fafc;
  }

  .course-name-wrapper {
    display: flex;
    flex-direction: column;
    gap: 2px;
  }

  .course-name-en {
    font-weight: 500;
    color: #1a1a1a;
  }

  .course-name-ja {
    font-size: 12px;
    color: #718096;
  }

  .field-wrapper {
    display: flex;
    flex-direction: column;
    gap: 2px;
  }

  .field-en {
    color: #2d3748;
  }

  .field-ja {
    font-size: 12px;
    color: #718096;
  }

  .level-badge {
    display: inline-block;
    padding: 4px 10px;
    border-radius: 12px;
    font-size: 12px;
    font-weight: 600;
  }

  .level-badge .level-en {
    font-size: 12px;
    font-weight: 600;
  }

  .level-badge .level-ja {
    font-size: 10px;
    font-weight: 400;
    margin-top: 2px;
  }

  .level-badge.level-bachelor-degree {
    background: #dbeafe;
    color: #1e40af;
  }

  .level-badge.level-masters-degree-coursework,
  .level-badge.level-masters-degree-research {
    background: #dcfce7;
    color: #166534;
  }

  .level-badge.level-doctoral-degree {
    background: #fef3c7;
    color: #92400e;
  }

  .tuition {
    font-weight: 600;
    color: #4a7fba;
  }

  /* Pagination */
  .pagination {
    margin-top: 30px;
    text-align: center;
  }

  .pagination * {
    border: none !important;
    box-shadow: none !important;
    outline: none !important;
  }

  .pagination nav {
    display: inline-flex;
    gap: 6px;
    background: none;
  }

  .pagination .page a,
  .pagination .page span,
  .pagination .first a,
  .pagination .prev a,
  .pagination .next a,
  .pagination .last a {
    padding: 8px 12px !important;
    background: white !important;
    border: 1px solid #e2e8f0 !important;
    border-radius: 6px !important;
    color: #4a5568 !important;
    text-decoration: none;
    display: inline-block;
  }

  .pagination .page.current span,
  .pagination .page.active span,
  .pagination .current span,
  .pagination span.current {
    padding: 8px 12px !important;
    background: #4a7fba !important;
    color: white !important;
    border: 1px solid #4a7fba !important;
    border-radius: 6px !important;
    display: inline-block;
  }

  .pagination .page a:hover,
  .pagination .first a:hover,
  .pagination .prev a:hover,
  .pagination .next a:hover,
  .pagination .last a:hover {
    background: #f7fafc !important;
  }

  .pagination .gap {
    padding: 8px 4px;
    color: #4a5568;
  }

  /* Data Note */
  .note-section-bg .data-note {
    max-width: 800px;
    margin: 0 auto;
    text-align: center;
    padding: 0 20px;
  }

  .note-section-bg .data-note p {
    font-size: 14px;
    line-height: 1.8;
    color: rgba(255, 255, 255, 0.85);
    margin: 0 0 8px 0;
  }

  .note-section-bg .data-note p:last-child {
    margin-bottom: 0;
  }

  .note-section-bg .data-note strong {
    color: #4a7fba;
  }

  /* Responsive Design */
  @media (max-width: 1024px) {
    .university-stats-grid {
      grid-template-columns: repeat(2, 1fr);
    }
  }

  @media (max-width: 768px) {
    .hero-image-slider {
      height: 300px;
    }

    .hero-content {
      padding: 40px 15px 30px;
    }

    .hero-title {
      font-size: 28px;
    }

    .hero-meta {
      flex-direction: column;
      gap: 15px;
    }

    .section-wrapper {
      padding: 35px 15px;
    }

    .university-stats-grid {
      grid-template-columns: 1fr;
      gap: 12px;
    }

    .stat-card {
      padding: 16px;
    }

    .stat-icon {
      width: 38px;
      height: 38px;
      font-size: 14px;
    }

    .stat-value {
      font-size: 20px;
    }

    .info-card,
    .courses-card {
      padding: 25px 20px;
    }

    .info-card h2,
    .courses-header h2 {
      font-size: 22px;
    }

    .courses-header {
      flex-direction: column;
      align-items: stretch;
    }

    .filter-group {
      flex-direction: column;
      gap: 8px;
    }

    .filter-select {
      width: 100%;
    }

    /* Mobile Table Card View */
    .courses-table table {
      display: block;
    }

    .courses-table thead {
      display: none;
    }

    .courses-table tbody {
      display: block;
    }

    .courses-table tr {
      display: block;
      margin-bottom: 15px;
      background: #f9fafb;
      border: 1px solid #e2e8f0;
      border-radius: 8px;
      padding: 15px;
    }

    .courses-table td {
      display: block;
      padding: 8px 0;
      border-bottom: none;
      position: relative;
      padding-left: 35%;
    }

    .courses-table td::before {
      content: attr(data-label);
      position: absolute;
      left: 0;
      width: 32%;
      font-weight: 600;
      color: #4a5568;
      font-size: 12px;
    }

    .courses-table td.course-name {
      padding-left: 0;
      border-bottom: 1px solid #e2e8f0;
      margin-bottom: 10px;
      padding-bottom: 10px;
    }

    .courses-table td.course-name::before {
      display: none;
    }

    .hero-slider-btn {
      width: 36px;
      height: 36px;
      font-size: 14px;
    }

    .hero-slider-prev { left: 10px; }
    .hero-slider-next { right: 10px; }
  }

  @media (max-width: 480px) {
    .hero-image-slider {
      height: 220px;
    }

    .hero-title {
      font-size: 24px;
    }

    .hero-breadcrumb {
      font-size: 12px;
    }

    .section-wrapper {
      padding: 30px 12px;
    }

    .info-card,
    .courses-card {
      padding: 20px 15px;
    }

    .info-card h2,
    .courses-header h2 {
      font-size: 20px;
    }

    .stat-card {
      padding: 14px;
      gap: 10px;
    }

    .stat-icon {
      width: 34px;
      height: 34px;
    }

    .stat-value {
      font-size: 18px;
    }

    .stat-label {
      font-size: 11px;
    }
  }
</style>

<script>
  function submitWithScroll(form) {
    // 現在のスクロール位置を取得
    const scrollPos = window.pageYOffset || document.documentElement.scrollTop;
    
    // hiddenフィールドにスクロール位置を保存
    let scrollInput = form.querySelector('input[name="scroll_pos"]');
    if (!scrollInput) {
      scrollInput = document.createElement('input');
      scrollInput.type = 'hidden';
      scrollInput.name = 'scroll_pos';
      form.appendChild(scrollInput);
    }
    scrollInput.value = scrollPos;
    
    // フォームを送信
    form.submit();
  }
  
  // ページ読み込み時にスクロール位置を復元
  document.addEventListener('DOMContentLoaded', function() {
    const urlParams = new URLSearchParams(window.location.search);
    const scrollPos = urlParams.get('scroll_pos');
    
    if (scrollPos) {
      // URLからscroll_posパラメータを削除
      urlParams.delete('scroll_pos');
      const newUrl = window.location.pathname + (urlParams.toString() ? '?' + urlParams.toString() : '') + window.location.hash;
      window.history.replaceState({}, document.title, newUrl);
      
      // スクロール位置を復元
      setTimeout(function() {
        window.scrollTo(0, parseInt(scrollPos));
      }, 100);
    } else if (window.location.hash === '#courses') {
      // アンカーリンクがある場合
      setTimeout(function() {
        const element = document.getElementById('courses');
        if (element) {
          element.scrollIntoView({ behavior: 'smooth' });
        }
      }, 100);
    }
  });
// Hero image slider functionality
function initializeHeaderSlider() {
  const slider = document.querySelector('.hero-image-slider');
  if (!slider) return;

  const slides = slider.querySelectorAll('.hero-slide');
  const dots = slider.querySelectorAll('.hero-dot');
  const prevBtn = slider.querySelector('.hero-slider-prev');
  const nextBtn = slider.querySelector('.hero-slider-next');
  let currentSlide = 0;
  let touchStartX = 0;
  let touchEndX = 0;
  let autoPlayInterval;
  
  function showSlide(index) {
    slides.forEach((slide, i) => {
      slide.classList.toggle('active', i === index);
    });
    dots.forEach((dot, i) => {
      dot.classList.toggle('active', i === index);
    });
    currentSlide = index;
  }
  
  function handleSwipe() {
    const swipeThreshold = 50;
    const diff = touchStartX - touchEndX;
    
    if (Math.abs(diff) > swipeThreshold) {
      // 自動再生を一時停止して再開
      clearInterval(autoPlayInterval);
      startAutoPlay();
      
      if (diff > 0) {
        // Swipe left - next slide
        const newIndex = currentSlide === slides.length - 1 ? 0 : currentSlide + 1;
        showSlide(newIndex);
      } else {
        // Swipe right - previous slide
        const newIndex = currentSlide === 0 ? slides.length - 1 : currentSlide - 1;
        showSlide(newIndex);
      }
    }
  }
  
  // タッチイベントの追加
  slider.addEventListener('touchstart', (e) => {
    touchStartX = e.changedTouches[0].screenX;
  }, { passive: true });
  
  slider.addEventListener('touchend', (e) => {
    touchEndX = e.changedTouches[0].screenX;
    handleSwipe();
  }, { passive: true });
  
  if (prevBtn) {
    prevBtn.addEventListener('click', () => {
      clearInterval(autoPlayInterval);
      startAutoPlay();
      const newIndex = currentSlide === 0 ? slides.length - 1 : currentSlide - 1;
      showSlide(newIndex);
    });
  }
  
  if (nextBtn) {
    nextBtn.addEventListener('click', () => {
      clearInterval(autoPlayInterval);
      startAutoPlay();
      const newIndex = currentSlide === slides.length - 1 ? 0 : currentSlide + 1;
      showSlide(newIndex);
    });
  }
  
  dots.forEach((dot, index) => {
    dot.addEventListener('click', () => {
      clearInterval(autoPlayInterval);
      startAutoPlay();
      showSlide(index);
    });
  });
  
  // Auto-play slider
  function startAutoPlay() {
    autoPlayInterval = setInterval(() => {
      const newIndex = currentSlide === slides.length - 1 ? 0 : currentSlide + 1;
      showSlide(newIndex);
    }, 5000);
  }
  
  // 初期自動再生開始
  startAutoPlay();
}

// Initialize slider when page loads
document.addEventListener('DOMContentLoaded', function() {
  initializeHeaderSlider();
});

// Also initialize on Turbo navigation
document.addEventListener('turbo:load', function() {
  initializeHeaderSlider();
});
</script>