<div class="au-universities-container">
  <div class="hero-section">
    <h1>オーストラリア大学検索</h1>
    <p>オーストラリアの主要39大学から、あなたに最適な大学を見つけましょう</p>
  </div>

  <div class="search-section">
    <%= form_with url: search_au_universities_path, method: :get, local: true, class: "search-form" do |f| %>
      <div class="search-input-group">
        <%= text_field_tag :q, params[:q], 
            placeholder: "大学名、都市、コース名で検索...", 
            class: "search-input" %>
        <%= submit_tag "検索", class: "search-button" %>
      </div>
      <div class="search-options">
        <%= check_box_tag :search_courses, '1', params[:search_courses] == '1' %>
        <%= label_tag :search_courses, "コース名も含めて検索" %>
      </div>
    <% end %>
  </div>

  <div class="filters-section">
    <%= form_with url: au_universities_path, method: :get, local: true, class: "filter-form" do |f| %>
      <div class="filter-row">
        <div class="filter-item">
          <label>州</label>
          <%= select_tag :state, 
              options_for_select([
                ['すべて', ''],
                ['NSW (シドニー)', 'NSW'],
                ['VIC (メルボルン)', 'VIC'],
                ['QLD (ブリスベン)', 'QLD'],
                ['WA (パース)', 'WA'],
                ['SA (アデレード)', 'SA'],
                ['ACT (キャンベラ)', 'ACT'],
                ['TAS (タスマニア)', 'TAS'],
                ['NT (ダーウィン)', 'NT']
              ], params[:state]),
              class: "filter-select" %>
        </div>

        <div class="filter-item">
          <label>年間授業料（AUD）</label>
          <div class="filter-range">
            <%= number_field_tag :min_tuition, params[:min_tuition], 
                placeholder: "最小", class: "filter-input-small" %>
            <span>〜</span>
            <%= number_field_tag :max_tuition, params[:max_tuition], 
                placeholder: "最大", class: "filter-input-small" %>
          </div>
        </div>

        <div class="filter-item">
          <label>並び順</label>
          <%= select_tag :sort,
              options_for_select([
                ['大学名順', 'name'],
                ['授業料が安い順', 'tuition_low'],
                ['授業料が高い順', 'tuition_high'],
                ['コース数が多い順', 'courses']
              ], params[:sort]),
              class: "filter-select" %>
        </div>

        <div class="filter-submit">
          <%= submit_tag "絞り込む", class: "filter-button" %>
        </div>
      </div>
    <% end %>
  </div>

  <div class="results-info">
    <p><%= @total_count %>校の大学が見つかりました</p>
  </div>

  <div class="universities-grid">
    <% @universities.each do |university| %>
      <div class="university-card">
        <div class="university-header">
          <h3><%= link_to university.name, au_university_path(university) %></h3>
          <span class="location"><i class="fas fa-map-marker-alt"></i> <%= university.city %>, <%= university.state %></span>
        </div>
        
        <div class="university-stats">
          <div class="stat-item">
            <span class="stat-label">全学生数</span>
            <span class="stat-value"><%= number_with_delimiter(university.total_students_2023 || 0) %></span>
          </div>
          <div class="stat-item">
            <span class="stat-label">留学生比率</span>
            <span class="stat-value">
              <% if university.overseas_percentage %>
                <%= university.overseas_percentage.round(0) %>%
              <% else %>
                -
              <% end %>
            </span>
          </div>
          <div class="stat-item">
            <span class="stat-label">コース数</span>
            <span class="stat-value"><%= university.total_courses_count %></span>
          </div>
        </div>

        <div class="university-tuition">
          <div class="tuition-label">年間授業料（AUD）</div>
          <div class="tuition-range">
            <% if university.min_annual_tuition && university.max_annual_tuition %>
              $<%= number_with_delimiter(university.min_annual_tuition.to_i) %> 
              〜 
              $<%= number_with_delimiter(university.max_annual_tuition.to_i) %>
            <% else %>
              データなし
            <% end %>
          </div>
        </div>

        <% if university.popular_fields.present? %>
          <div class="university-fields">
            <div class="fields-label">人気の分野</div>
            <div class="fields-list">
              <%= university.popular_fields %>
            </div>
          </div>
        <% end %>

        <div class="university-actions">
          <%= link_to "詳細を見る", au_university_path(university), class: "btn-detail" %>
          <% if university.website.present? %>
            <%= link_to "公式サイト", university.website, target: "_blank", class: "btn-website" %>
          <% end %>
        </div>
      </div>
    <% end %>
  </div>
</div>

<style>
  .au-universities-container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 20px;
  }

  .hero-section {
    text-align: center;
    padding: 40px 0;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    border-radius: 10px;
    margin-bottom: 30px;
  }

  .hero-section h1 {
    font-size: 2.5rem;
    margin-bottom: 10px;
  }

  .hero-section p {
    font-size: 1.1rem;
    opacity: 0.95;
  }

  .search-section {
    background: white;
    padding: 30px;
    border-radius: 10px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.08);
    margin-bottom: 30px;
  }

  .search-input-group {
    display: flex;
    gap: 10px;
  }

  .search-input {
    flex: 1;
    padding: 12px 20px;
    border: 2px solid #e2e8f0;
    border-radius: 8px;
    font-size: 16px;
  }

  .search-button {
    padding: 12px 30px;
    background: #4c51bf;
    color: white;
    border: none;
    border-radius: 8px;
    font-size: 16px;
    cursor: pointer;
    transition: background 0.3s;
  }

  .search-button:hover {
    background: #434190;
  }

  .search-options {
    margin-top: 15px;
  }

  .filters-section {
    background: white;
    padding: 20px;
    border-radius: 10px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.08);
    margin-bottom: 20px;
  }

  .filter-row {
    display: flex;
    gap: 20px;
    align-items: flex-end;
    flex-wrap: wrap;
  }

  .filter-item {
    flex: 1;
    min-width: 150px;
  }

  .filter-item label {
    display: block;
    margin-bottom: 5px;
    font-weight: 600;
    color: #4a5568;
  }

  .filter-select, .filter-input-small {
    width: 100%;
    padding: 8px 12px;
    border: 1px solid #e2e8f0;
    border-radius: 6px;
  }

  .filter-range {
    display: flex;
    align-items: center;
    gap: 10px;
  }

  .filter-input-small {
    flex: 1;
  }

  .filter-button {
    padding: 10px 25px;
    background: #48bb78;
    color: white;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    transition: background 0.3s;
  }

  .filter-button:hover {
    background: #38a169;
  }

  .results-info {
    padding: 15px;
    background: #f7fafc;
    border-radius: 8px;
    margin-bottom: 20px;
    text-align: center;
    font-weight: 600;
  }

  .universities-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
    gap: 25px;
  }

  .university-card {
    background: white;
    border-radius: 10px;
    padding: 25px;
    box-shadow: 0 2px 15px rgba(0,0,0,0.08);
    transition: transform 0.3s, box-shadow 0.3s;
  }

  .university-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 5px 25px rgba(0,0,0,0.15);
  }

  .university-header h3 {
    margin: 0 0 10px 0;
    color: #2d3748;
  }

  .university-header h3 a {
    color: inherit;
    text-decoration: none;
  }

  .university-header h3 a:hover {
    color: #4c51bf;
  }

  .location {
    color: #718096;
    font-size: 14px;
  }

  .university-stats {
    display: flex;
    gap: 20px;
    margin: 20px 0;
    padding: 15px 0;
    border-top: 1px solid #e2e8f0;
    border-bottom: 1px solid #e2e8f0;
  }

  .stat-item {
    flex: 1;
    text-align: center;
  }

  .stat-label {
    display: block;
    font-size: 12px;
    color: #718096;
    margin-bottom: 5px;
  }

  .stat-value {
    display: block;
    font-size: 20px;
    font-weight: bold;
    color: #2d3748;
  }

  .university-tuition {
    margin: 20px 0;
  }

  .tuition-label {
    font-size: 14px;
    color: #718096;
    margin-bottom: 5px;
  }

  .tuition-range {
    font-size: 18px;
    font-weight: 600;
    color: #48bb78;
  }

  .university-fields {
    margin: 20px 0;
  }

  .fields-label {
    font-size: 14px;
    color: #718096;
    margin-bottom: 5px;
  }

  .fields-list {
    font-size: 14px;
    color: #2d3748;
  }

  .university-actions {
    display: flex;
    gap: 10px;
    margin-top: 20px;
  }

  .btn-detail, .btn-website {
    flex: 1;
    padding: 10px 15px;
    text-align: center;
    border-radius: 6px;
    text-decoration: none;
    transition: all 0.3s;
  }

  .btn-detail {
    background: #4c51bf;
    color: white;
  }

  .btn-detail:hover {
    background: #434190;
  }

  .btn-website {
    background: white;
    color: #4c51bf;
    border: 2px solid #4c51bf;
  }

  .btn-website:hover {
    background: #4c51bf;
    color: white;
  }
</style>