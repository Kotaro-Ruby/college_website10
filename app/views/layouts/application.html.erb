<!DOCTYPE html>
<html>
  <head>
    <title><%= content_for(:title) || "College Spark - アメリカ大学検索サイト" %></title>
    <meta name="description" content="<%= content_for(:description) || "6,300校以上のアメリカの大学から、あなたの条件に合った大学を検索できます。学費、合格率、専攻など詳細な情報で大学選びをサポートします。" %>">
    <meta name="keywords" content="<%= content_for(:keywords) || "アメリカ大学, 大学検索, 留学, 海外大学, College Spark, 大学選び, 学費, 合格率" %>">
    <meta name="author" content="College Spark">
    <meta name="robots" content="index, follow">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>
    
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-PRDMMDCHWX"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-PRDMMDCHWX');
    </script>

    <!-- OGP Tags -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="<%= content_for(:og_title) || content_for(:title) || "College Spark - アメリカ大学検索サイト" %>">
    <meta property="og:description" content="<%= content_for(:og_description) || content_for(:description) || "6,300校以上のアメリカの大学から、あなたの条件に合った大学を検索できます。学費、合格率、専攻など詳細な情報で大学選びをサポートします。" %>">
    <meta property="og:url" content="<%= request.original_url %>">
    <meta property="og:site_name" content="College Spark">
    <meta property="og:image" content="<%= content_for(:og_image) || "#{request.base_url}/icon.png" %>">
    <meta property="og:locale" content="ja_JP">
    
    <!-- Twitter Cards -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="<%= content_for(:twitter_title) || content_for(:og_title) || content_for(:title) || "College Spark - アメリカ大学検索サイト" %>">
    <meta name="twitter:description" content="<%= content_for(:twitter_description) || content_for(:og_description) || content_for(:description) || "6,300校以上のアメリカの大学から、あなたの条件に合った大学を検索できます。" %>">
    <meta name="twitter:image" content="<%= content_for(:twitter_image) || content_for(:og_image) || "#{request.base_url}/icon.png" %>">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="<%= content_for(:canonical_url) || request.original_url %>">

    <!-- Structured Data (JSON-LD) -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebSite",
      "name": "College Spark",
      "url": "<%= request.base_url %>",
      "description": "6,300校以上のアメリカの大学から、あなたの条件に合った大学を検索・比較できるサイト",
      "potentialAction": {
        "@type": "SearchAction",
        "target": {
          "@type": "EntryPoint",
          "urlTemplate": "<%= request.base_url %>/results?college_name={search_term_string}"
        },
        "query-input": "required name=search_term_string"
      },
      "publisher": {
        "@type": "Organization",
        "name": "College Spark",
        "url": "<%= request.base_url %>"
      }
    }
    </script>

    <%= yield :head %>

    <%# Enable PWA manifest for installable apps (make sure to enable in config/routes.rb too!) %>
    <%#= tag.link rel: "manifest", href: pwa_manifest_path(format: :json) %>

    <link rel="icon" href="/icon.svg" type="image/svg+xml">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon" href="/icon.svg">

    <%# Bootstrap CSS %>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <%# Includes all stylesheet files in app/assets/stylesheets %>
    <%= stylesheet_link_tag "application", "data-turbo-track": "reload", rel: "stylesheet" %>
    
    <%# Bootstrap JavaScript %>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.min.js"></script>
    
    <%= javascript_importmap_tags %>
  </head>

  <body style="margin: 0; min-height: 100vh; display: flex; flex-direction: column;">
    <%= render 'shared/header' %>
    <main style="flex: 1;">
      <%= yield %>
    </main>
    <%= render 'shared/footer' %>
  </body>
</html>
