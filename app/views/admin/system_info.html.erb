<!DOCTYPE html>
<html>
<head>
  <title>ã‚·ã‚¹ãƒ†ãƒ æƒ…å ± - College Spark ç®¡ç†ç”»é¢</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      font-family: 'Arial', sans-serif;
      margin: 0;
      padding: 20px;
      background: #f5f5f5;
      color: #333;
    }
    .container {
      max-width: 1200px;
      margin: 0 auto;
      background: white;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      overflow: hidden;
    }
    .header {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 30px;
      text-align: center;
    }
    .nav {
      background: #f8f9fa;
      padding: 20px;
      display: flex;
      gap: 15px;
      flex-wrap: wrap;
      justify-content: center;
    }
    .nav a {
      background: #007bff;
      color: white;
      padding: 10px 20px;
      text-decoration: none;
      border-radius: 5px;
      transition: background 0.3s;
    }
    .nav a:hover {
      background: #0056b3;
    }
    .nav a.active {
      background: #28a745;
    }
    .content {
      padding: 30px;
    }
    .info-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }
    .info-card {
      background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
      color: white;
      padding: 20px;
      border-radius: 10px;
      text-align: center;
    }
    .info-title {
      font-size: 0.9rem;
      opacity: 0.9;
      margin-bottom: 10px;
    }
    .info-value {
      font-size: 1.5rem;
      font-weight: bold;
    }
    .section {
      margin-bottom: 30px;
      padding: 20px;
      border: 1px solid #e0e0e0;
      border-radius: 8px;
    }
    .section h3 {
      margin-top: 0;
      color: #333;
      border-bottom: 2px solid #667eea;
      padding-bottom: 10px;
    }
    .status-good {
      color: #28a745;
      font-weight: bold;
    }
    .status-warning {
      color: #ffc107;
      font-weight: bold;
    }
    .status-error {
      color: #dc3545;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>âš™ï¸ ã‚·ã‚¹ãƒ†ãƒ æƒ…å ±</h1>
      <p>ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®è©³ç´°æƒ…å ±</p>
    </div>
    
    <div class="nav">
      <a href="/admin/dashboard?admin_key=college_admin_2025">ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</a>
      <a href="/admin/users?admin_key=college_admin_2025">ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§</a>
      <a href="/admin/contacts?admin_key=college_admin_2025">ãŠå•ã„åˆã‚ã›</a>
      <a href="/admin/system_info?admin_key=college_admin_2025" class="active">ã‚·ã‚¹ãƒ†ãƒ æƒ…å ±</a>
    </div>
    
    <div class="content">
      <div class="info-grid">
        <div class="info-card">
          <div class="info-title">ç’°å¢ƒ</div>
          <div class="info-value"><%= @info[:rails_env].upcase %></div>
        </div>
        <div class="info-card">
          <div class="info-title">Ruby ãƒãƒ¼ã‚¸ãƒ§ãƒ³</div>
          <div class="info-value"><%= @info[:ruby_version] %></div>
        </div>
        <div class="info-card">
          <div class="info-title">Rails ãƒãƒ¼ã‚¸ãƒ§ãƒ³</div>
          <div class="info-value"><%= @info[:rails_version] %></div>
        </div>
        <div class="info-card">
          <div class="info-title">ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹</div>
          <div class="info-value"><%= @info[:database_adapter] %></div>
        </div>
      </div>
      
      <div class="section">
        <h3>ğŸ“Š ãƒ‡ãƒ¼ã‚¿çµ±è¨ˆ</h3>
        <ul>
          <li><strong>ç™»éŒ²å¤§å­¦æ•°:</strong> <%= number_with_delimiter(@info[:total_colleges]) %>æ ¡</li>
          <li><strong>ç™»éŒ²ãƒ¦ãƒ¼ã‚¶ãƒ¼æ•°:</strong> <%= @info[:total_users] %>å</li>
          <li><strong>ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒãƒ¼ã‚¸ãƒ§ãƒ³:</strong> <%= @info[:app_version] %></li>
        </ul>
      </div>
      
      <div class="section">
        <h3>ğŸ”§ ã‚·ã‚¹ãƒ†ãƒ çŠ¶æ³</h3>
        <ul>
          <li>
            <strong>ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶š:</strong> 
            <% begin %>
              <% ActiveRecord::Base.connection.execute("SELECT 1") %>
              <span class="status-good">âœ… æ­£å¸¸</span>
            <% rescue => e %>
              <span class="status-error">âŒ ã‚¨ãƒ©ãƒ¼: <%= e.message %></span>
            <% end %>
          </li>
          <li>
            <strong>ãŠå•ã„åˆã‚ã›ãƒ•ã‚¡ã‚¤ãƒ«:</strong>
            <% if File.exist?(Rails.root.join('storage', 'contacts', 'contact_submissions.txt')) %>
              <span class="status-good">âœ… å­˜åœ¨</span>
            <% else %>
              <span class="status-warning">âš ï¸ æœªä½œæˆ</span>
            <% end %>
          </li>
          <li>
            <strong>ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª:</strong>
            <% if Dir.exist?(Rails.root.join('storage')) %>
              <span class="status-good">âœ… å­˜åœ¨</span>
            <% else %>
              <span class="status-error">âŒ æœªä½œæˆ</span>
            <% end %>
          </li>
        </ul>
      </div>
      
      <div class="section">
        <h3>ğŸ“‹ ç’°å¢ƒå¤‰æ•°ãƒã‚§ãƒƒã‚¯</h3>
        <ul>
          <li>
            <strong>GMAIL_USERNAME:</strong>
            <%= ENV['GMAIL_USERNAME'].present? ? "âœ… è¨­å®šæ¸ˆã¿" : "âŒ æœªè¨­å®š" %>
          </li>
          <li>
            <strong>GMAIL_PASSWORD:</strong>
            <%= ENV['GMAIL_PASSWORD'].present? ? "âœ… è¨­å®šæ¸ˆã¿" : "âŒ æœªè¨­å®š" %>
          </li>
          <li>
            <strong>RAILS_MASTER_KEY:</strong>
            <%= ENV['RAILS_MASTER_KEY'].present? ? "âœ… è¨­å®šæ¸ˆã¿" : "âŒ æœªè¨­å®š" %>
          </li>
          <li>
            <strong>DATABASE_URL:</strong>
            <%= ENV['DATABASE_URL'].present? ? "âœ… è¨­å®šæ¸ˆã¿" : "âŒ æœªè¨­å®š" %>
          </li>
        </ul>
      </div>
      
      <div class="section">
        <h3>â„¹ï¸ ã‚µãƒ¼ãƒãƒ¼æƒ…å ±</h3>
        <ul>
          <li><strong>ãƒ›ã‚¹ãƒˆå:</strong> <%= `hostname`.strip rescue 'Unknown' %></li>
          <li><strong>ç¾åœ¨æ™‚åˆ»:</strong> <%= Time.current.strftime('%Yå¹´%mæœˆ%dæ—¥ %Hæ™‚%Måˆ†%Sç§’') %></li>
          <li><strong>ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³:</strong> <%= Time.zone.name %></li>
          <li><strong>Rails ãƒ«ãƒ¼ãƒˆ:</strong> <%= Rails.root %></li>
        </ul>
      </div>
    </div>
  </div>
</body>
</html>