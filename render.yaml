services:
  - type: web
    name: College_Spark   # College Spark サービス名
    env: ruby
    plan: free
    region: oregon
    branch: main
    buildCommand: ./bin/render-build.sh
    startCommand: bundle exec puma -C config/puma.rb
    releaseCommand: |
      bundle exec rails db:migrate
      bundle exec rails db:safe_reset_conditions
      if [ -f "db/college_data_compressed.json.gz" ]; then
        cp db/college_data_compressed.json.gz tmp/
        bundle exec rails import:from_compressed
      fi